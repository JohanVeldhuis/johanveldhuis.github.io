<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Installing Exchange 2013 RTM using the command prompt</title>
	
	<meta name="author" content="Johan Veldhuis">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="/assets/css/style.css" rel="stylesheet">

	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

	<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
</head>

<body>
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com/dbtek">
				<i class="fa fa-github"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="http://twitter.com/jveldh">
				<i class="fa fa-twitter"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="mailto:johan@johanveldhuis.nl">
				<i class="fa fa-envelope"></i>
			</a>
			
			<a class="navbar-brand" href="/">
				<img src="//www.gravatar.com/avatar/8209ff9e4ba94ac3058e69fd75354b3f?s=35" class="img-circle" />
				Johan&#039;s Web Portal
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/">Home</a></li>
				<li><a href="/categories.html">Categories</a></li>
				<li><a href="/tags.html">Tags</a></li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/"><i class="fa fa-home"></i>Home</a></li>
			<li><a href="/categories.html"><i class="fa fa-folder"></i>Categories</a></li>
			<li><a href="/tags.html"><i class="fa fa-tags"></i>Tags</a></li>
			<li><a href="/about.html"><i class="fa fa-eye"></i>About</a></li>
			<li class="divider"></li>
			<li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>

	<div class="col-sm-3 sidebar hidden-xs" style="">
		<!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/">
		<img src="//www.gravatar.com/avatar/8209ff9e4ba94ac3058e69fd75354b3f?s=150" class="img-circle" />
	</a>
	<h3 class="title">
        <a href="/">Johan&#039;s Web Portal</a>
    </h3>
</header>



<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/dbtek">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com/jveldh">
				<i class="fa fa-twitter fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="mailto:johan@johanveldhuis.nl">
				<i class="fa fa-envelope fa-lg"></i>
			</a>
		</li>
		
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		
		
		<li>
			<a class="btn btn-default btn-sm" href="/feed.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>
</div>
<!-- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3">
		<div class="page-header">
  <h1>Installing Exchange 2013 RTM using the command prompt </h1>
</div>
	
<article>

	<div class="col-sm-10">
	 <span class="post-date">
	   
	   October 
	   26th,
	   
	   2012
	 </span>
	  <div class="article_body">
	  <p>In this blog we will have a look how we can implement a multi rol Exchange 2013 server. We will install the RTM version of Exchange 2013 on a Windows 2012 server.</p>

<p>Before you start the installation of Exchange 2013 you will need to install some prerequisits.</p>

<p>Before extending the schema you will need to install the ADDS tools on the system. These can be installed very easy by insing the following Powershell cmdlet <em>Install-WindowsFeature RSAT-ADDS</em></p>

<p style="text-align: center;">
  <a href="https://i0.wp.com/johanveldhuis.nl/wp-content/uploads/2012/10/install-windowsfeature-rsat-adds.png"><img class="aligncenter" title="install-windowsfeature rsat-adds" src="https://i2.wp.com/johanveldhuis.nl/wp-content/uploads/2012/10/install-windowsfeature-rsat-adds-300x33.png?resize=300%2C33" alt="" width="300" height="33" data-recalc-dims="1" /></a>
</p>

<p>Once the installation has finished it’s time to install the other prerequisites. Which features of Windows you will need to install depends on the server roles which are installed. The example below will install all prerequisites for a multi role server:</p>

<p><em>Install-WindowsFeature AS-HTTP-Activation, Desktop-Experience, NET-Framework-45-Features, RPC-over-HTTP-proxy, RSAT-Clustering, RSAT-Clustering-CmdInterface, Web-Mgmt-Console, WAS-Process-Model, Web-Asp-Net45, Web-Basic-Auth, Web-Client-Auth, Web-Digest-Auth, Web-Dir-Browsing, Web-Dyn-Compression, Web-Http-Errors, Web-Http-Logging, Web-Http-Redirect, Web-Http-Tracing, Web-ISAPI-Ext, Web-ISAPI-Filter, Web-Lgcy-Mgmt-Console, Web-Metabase, Web-Mgmt-Console, Web-Mgmt-Service, Web-Net-Ext45, Web-Request-Monitor, Web-Server, Web-Stat-Compression, Web-Static-Content, Web-Windows-Auth, Web-WMI, Windows-Identity-Foundation</em></p>

<p style="text-align: center;">
  <a href="https://i1.wp.com/johanveldhuis.nl/wp-content/uploads/2012/10/install-windowsfeature-other.png"><img class="aligncenter" title="install-windowsfeature other prerequisites" src="https://i2.wp.com/johanveldhuis.nl/wp-content/uploads/2012/10/install-windowsfeature-other-300x25.png?resize=300%2C25" alt="" width="300" height="25" data-recalc-dims="1" /></a>
</p>

<p>After the installation of the prerequisites has completed you will need to reboot the server. Once rebooted it’s time for the last three prerequisites. These need to be downloaded from the Microsoft website, below you will find the links for the three downloads:</p>

<ul>
  <li><a href="http://go.microsoft.com/fwlink/p/?linkId=260990">Microsoft Unified Communications Managed API 4.0, Core Runtime 64-bit</a></li>
  <li><a href="http://go.microsoft.com/fwlink/p/?linkID=191548">Microsoft Office 2010 Filter Pack 64 bit</a></li>
  <li><a href="http://go.microsoft.com/fwlink/p/?LinkId=254043">Microsoft Office 2010 Filter Pack SP1 64 bit</a></li>
</ul>

<p>Install them in the order as listed above. Once these files have been installed finally time to install Exchange.</p>

<p>You will have two options to install Exchange 2013 via the GUI of via the command prompt. Since several manuals can be found how to install it via the GUI we will use the command prompt. We will install Exchange 2013 in seperate steps. First we will prepare the schema. Make sure the account the account which is used for the installation is a member of the Schema Admins and Enterprise Admins. During this step several objects are added to the Active Directory schema which are necessary for Exchange 2013.</p>

<p>Open the command prompt, browse to the Exchange 2013 setup directory en execute the following command:</p>

<p><em>setup.exe /PS /IAcceptExchangeServerLicenseTerms</em></p>

<p style="text-align: center;">
  <em><a href="https://i1.wp.com/johanveldhuis.nl/wp-content/uploads/2012/10/schema-prep.png"><img class="aligncenter" title="AD Schema Prep" src="https://i0.wp.com/johanveldhuis.nl/wp-content/uploads/2012/10/schema-prep-300x88.png?resize=300%2C88" alt="" width="300" height="88" data-recalc-dims="1" /></a></em>
</p>

<p>The setup will tell you if the extension of the schema completed succesfully or not. Optionally you could use <em>ADSIEdit</em> to verify if the schema is extended. Verify if the value of the object <em>ms-Exch-Schema-Verision-Pt</em> and more specific the parameter _rangUpper _has the value 15137.</p>

<p style="text-align: center;">
  <a href="https://i0.wp.com/johanveldhuis.nl/wp-content/uploads/2012/10/adsiedit_schema.png"><img class="aligncenter" title="Adsiedit" src="https://i0.wp.com/johanveldhuis.nl/wp-content/uploads/2012/10/adsiedit_schema-300x190.png?resize=300%2C190" alt="" width="300" height="190" data-recalc-dims="1" /></a>
</p>

<p>Now the schema has been extended it’s time for the next step prepare the AD. This can be done by using the following cmdlet:</p>

<p><strong>setup.exe /P  /OrganizationName: “First Organizationname” /IAcceptExchangeServerLicenseTerms</strong></p>

<p>During this steps several security groups are created for Exchange 2013. Besides this several objects are created in the configuration partition of AD. After the step has completed you can use <em>Active Directory Users &amp; Computers</em> and <em>ADSIEdit</em> to verify if the step has completed succesfully.</p>

<p style="text-align: center;">
  <a href="https://i1.wp.com/johanveldhuis.nl/wp-content/uploads/2012/10/aduc.png"><img class="aligncenter" title="Active Directory Users and Computers" src="https://i1.wp.com/johanveldhuis.nl/wp-content/uploads/2012/10/aduc.png?resize=257%2C170" alt="" width="257" height="170" data-recalc-dims="1" /></a>
</p>

<p style="text-align: center;">
  <a href="https://i2.wp.com/johanveldhuis.nl/wp-content/uploads/2012/10/ad_config.png"><img class="aligncenter" title="Configuration partition" src="https://i0.wp.com/johanveldhuis.nl/wp-content/uploads/2012/10/ad_config-300x191.png?resize=300%2C191" alt="" width="300" height="191" data-recalc-dims="1" /></a>
</p>

<p>After the AD has been prepped it’s time to install the bits.</p>

<p>To start the installation run setup using the following cmdlets:</p>

<p><em>Setup.exe /mode:Install /role:ClientAccess,Mailbox /IAcceptExchangeServerLicenseTerms</em></p>

<p>By using these parameters both the Client Access and Mailbox Server role will be installed on the server</p>

<p style="text-align: center;">
  <a href="https://i2.wp.com/johanveldhuis.nl/wp-content/uploads/2012/10/setup-finished.png"><img class="aligncenter" title="setup finished" src="https://i2.wp.com/johanveldhuis.nl/wp-content/uploads/2012/10/setup-finished-300x212.png?resize=300%2C212" alt="" width="300" height="212" data-recalc-dims="1" /></a>
</p>

<p>As you can see a reboot is required, after the reboot it’s time to configure Exchange.</p>

<p>Here ends the blog in which we talked about how to install Exchange 2013 on a Windows 2013 server. In the next blog we will have a look at how to configure Exchange 2013.</p>

	  </div>
		
		
		<ul class="tag_box list-unstyled list-inline">
		  <li><i class="fa fa-folder-open"></i></li>
		  
		  
			 
				<li><a href="/categories.html#Exchange 2013-ref">
					Exchange 2013 <span>(19)</span>
					
				</a></li>
			
		  
		</ul>
		  

		  

		<hr>

		<h4>Comments</h4>
		
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'johanveldhuis';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



		<hr>

		<div>
      <section class="share col-sm-6">
        <h4 class="section-title">Share Post</h4>
        <a class="btn btn-default btn-sm twitter" href="http://twitter.com/share?text=Installing Exchange 2013 RTM using the command prompt&via=jveldh"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <i class="fa fa-twitter fa-lg"></i>
          Twitter
        </a>
        <a class="btn btn-default btn-sm facebook" href="https://www.facebook.com/sharer/sharer.php"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <i class="fa fa-facebook fa-lg"></i>
          Facebook
        </a>
        <a class="btn btn-default btn-sm gplus"
           onclick="window.open('https://plus.google.com/share?url='+window.location.href, 'google-plus-share', 'width=490,height=530');return false;">
          <i class="fa fa-google-plus fa-lg"></i>
          Google+
        </a>
      </section>

      <section class="col-sm-6 author">
        <img src="//www.gravatar.com/avatar/8209ff9e4ba94ac3058e69fd75354b3f" class="img-rounded author-image" />
        <h4 class="section-title author-name">Johan Veldhuis</h4>
        <p class="author-bio"></p>
      </section>
    </div>

    <div class="clearfix"></div>

		<ul class="pager">
		  
		  <li class="previous"><a href="/federation-issue-na-migratie-van-live-edu-naar-office-365/" title="Federation issue after Live.edu is migrated to Office 365">&larr; Previous</a></li>
		  
		  
		  <li class="next"><a href="/exchange-2013-rtm-configureren-via-the-exchange-management-shell/" title="Configure Exchange 2013 RTM via the Exchange Management Shell">Next &rarr;</a></li>
		  
		</ul>

		<hr>
	</div>
	
	<div class="col-sm-2 sidebar-2">
	
	</div>
</article>
<div class="clearfix"></div>





		<footer>
			<hr/>
			<p>
				&copy; 2019 Johan Veldhuis with <a href="http://jekyllrb.com/">Jekyll</a>. Theme: <a href="https://github.com/dbtek/dbyll">dbyll</a> by dbtek.
			</p>
		</footer>
	</div>

	<script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/assets/js/app.js"></script>
</body>
</html>



<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'johanveldhuis', 'auto');
  ga('send', 'pageview');
</script>

