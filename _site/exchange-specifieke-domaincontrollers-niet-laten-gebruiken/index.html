<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Exclude domain-controllers to be used by Exchange</title>
	
	<meta name="author" content="Johan Veldhuis">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="/assets/css/style.css" rel="stylesheet">

	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

	<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
</head>

<body>
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com/dbtek">
				<i class="fa fa-github"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="http://twitter.com/jveldh">
				<i class="fa fa-twitter"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="mailto:johan@johanveldhuis.nl">
				<i class="fa fa-envelope"></i>
			</a>
			
			<a class="navbar-brand" href="/">
				<img src="//www.gravatar.com/avatar/8209ff9e4ba94ac3058e69fd75354b3f?s=35" class="img-circle" />
				Johan&#039;s Web Portal
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/">Home</a></li>
				<li><a href="/categories.html">Categories</a></li>
				<li><a href="/tags.html">Tags</a></li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/"><i class="fa fa-home"></i>Home</a></li>
			<li><a href="/categories.html"><i class="fa fa-folder"></i>Categories</a></li>
			<li><a href="/tags.html"><i class="fa fa-tags"></i>Tags</a></li>
			<li><a href="/about.html"><i class="fa fa-eye"></i>About</a></li>
			<li class="divider"></li>
			<li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>

	<div class="col-sm-3 sidebar hidden-xs" style="">
		<!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/">
		<img src="//www.gravatar.com/avatar/8209ff9e4ba94ac3058e69fd75354b3f?s=150" class="img-circle" />
	</a>
	<h3 class="title">
        <a href="/">Johan&#039;s Web Portal</a>
    </h3>
</header>



<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/dbtek">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com/jveldh">
				<i class="fa fa-twitter fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="mailto:johan@johanveldhuis.nl">
				<i class="fa fa-envelope fa-lg"></i>
			</a>
		</li>
		
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		
		
		<li>
			<a class="btn btn-default btn-sm" href="/feed.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>
</div>
<!-- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3">
		<div class="page-header">
  <h1>Exclude domain-controllers to be used by Exchange </h1>
</div>
	
<article>

	<div class="col-sm-10">
	 <span class="post-date">
	   
	   October 
	   12th,
	   
	   2009
	 </span>
	  <div class="article_body">
	  <p>As you may already know Exchange does a discovery to find the domain controllers  in the AD. When you have a look at the application event log you will see events with the source _MsExchange ADAccess _and Event id _2080. _This event will be seen every 15 minutes, this because the check is performed every 15 minutes.</p>

<p>The event can contain the following info:</p>

<p>_Event Type: Information</p>

<p>Event Source: MSExchangeDSAccess</p>

<p>Event Category: Topology</p>

<p>Event ID: 2080</p>

<p>Computer: Ex01</p>

<p>Description:</p>

<p>Process MAD.EXE (PID=1808). DSAccess has discovered the following servers with the following characteristics:</p>

<table>
  <tbody>
    <tr>
      <td>(Server name</td>
      <td>Roles</td>
      <td>Reachability</td>
      <td>Synchronized</td>
      <td>GC capable</td>
      <td>PDC</td>
      <td>SACL right</td>
      <td>Critical Data</td>
      <td>Netlogon</td>
      <td>OS Version)</td>
    </tr>
  </tbody>
</table>

<p>In-site:</p>

<p>dc01.domain.com  CDG 7 7 1 0 0 1 7 1</p>

<p>dc02.domain.com  CDG 7 7 1 0 1 1 7 1_</p>

<p>Out-of-site:</p>

<p>For more information, click <a href="http://search.support.microsoft.com/search/?adv=1">http://search.support.microsoft.com/search/?adv=1</a>.</p>

<p>Nice all those shortnames and numbers but what do they mean:</p>

<ul>
  <li><em>servername,</em> the first column contains the servername of the domain controller</li>
  <li><em>roles,</em> which roles does the domain controller fullfill: C the domain controller will be used as a configuration domain controller, D a domain controller and G a domain controller which is also a global catalog server. When seeing a – this means that the role is not fullfilled by the domain controller</li>
  <li><em>reachability,</em> each 15 minutes a connection is made to the server. When the server fullfills the role of global catalog server it tries to connect on port 3268,  when this succeeds the value 0x1 will de displayed. When a connection can be made to port 389 the server knows it is a domain controller and will display the value 0x2. When the server is also a configuration domain controller again a connection is made to port 389. If this succeeds it will get the value 0x4. When a server fullfills multiple roles all values will be added up, for example when a server fullfills 3 roles: 0x1+0x2+0x4=0x7.</li>
  <li><em>synchronized, _when the _isSynchronizedflag _is set on the rootDSE of the domain controller this value will be set to true. The values in the column are used in the same way the are used in the collumn _reachability</em>.</li>
  <li>_GC capable, _is the domain controller also a Global Catalog Server</li>
  <li><em>PDC,</em> is the domain controller also the PDC for the domein</li>
  <li>_SACL right, _are the rights correct for DSAccess to read the SACL</li>
  <li><em>Critical Data</em>, this will tell you if DSAccess found the Exchange Server in the configuration partition of the domain controller.</li>
  <li><em>Netlogon Check,</em> can a connection be made to the netlogon server of the domain controller</li>
  <li><em>OS version,</em> when this value is 1 it will tell you the domain controller has a OS which is Windows 2003 Service Pack 3 minimal.</li>
</ul>

<p>It may happen that you don’t want to use a specific domain controller. But how can you configure this ?</p>

<p>You can do this with the command: <em>set-exchangeserver -identity exchange.domain.com -StaticExcludedDomainControllers dc.domain.com</em></p>

<p>When you would like to specify the configuration domain controller, domain controller(s) and global catalog server(s) yourself use the following command: <em>set-exchangeserver -identity exhange.domain.com</em> -S_taticConfigDomainController dc01.domain.com -StaticDomainController dc01.domain.com,dc02.domain.com -StaticGlobalCatalogs dc01.domain.com_</p>

<p>Technet set-exchangeserver <a href="http://technet.microsoft.com/en-us/library/bb123716.aspx" target="_blank">open</a></p>

	  </div>
		
		
		<ul class="tag_box list-unstyled list-inline">
		  <li><i class="fa fa-folder-open"></i></li>
		  
		  
			 
				<li><a href="/categories.html#Exchange-ref">
					Exchange <span>(30)</span>
					
				</a></li>
			
		  
		</ul>
		  

		  

		<hr>

		<h4>Comments</h4>
		
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'johanveldhuis';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



		<hr>

		<div>
      <section class="share col-sm-6">
        <h4 class="section-title">Share Post</h4>
        <a class="btn btn-default btn-sm twitter" href="http://twitter.com/share?text=Exclude domain-controllers to be used by Exchange&via=jveldh"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <i class="fa fa-twitter fa-lg"></i>
          Twitter
        </a>
        <a class="btn btn-default btn-sm facebook" href="https://www.facebook.com/sharer/sharer.php"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <i class="fa fa-facebook fa-lg"></i>
          Facebook
        </a>
        <a class="btn btn-default btn-sm gplus"
           onclick="window.open('https://plus.google.com/share?url='+window.location.href, 'google-plus-share', 'width=490,height=530');return false;">
          <i class="fa fa-google-plus fa-lg"></i>
          Google+
        </a>
      </section>

      <section class="col-sm-6 author">
        <img src="//www.gravatar.com/avatar/8209ff9e4ba94ac3058e69fd75354b3f" class="img-rounded author-image" />
        <h4 class="section-title author-name">Johan Veldhuis</h4>
        <p class="author-bio"></p>
      </section>
    </div>

    <div class="clearfix"></div>

		<ul class="pager">
		  
		  <li class="previous"><a href="/exchange-2010-rtm-beschikbaar/" title="Exchange 2010 RTM available">&larr; Previous</a></li>
		  
		  
		  <li class="next"><a href="/nieuwe-cas-server-wordt-niet-gebruikt-door-clients/" title="New CAS-server not used by clients">Next &rarr;</a></li>
		  
		</ul>

		<hr>
	</div>
	
	<div class="col-sm-2 sidebar-2">
	
	</div>
</article>
<div class="clearfix"></div>





		<footer>
			<hr/>
			<p>
				&copy; 2019 Johan Veldhuis with <a href="http://jekyllrb.com/">Jekyll</a>. Theme: <a href="https://github.com/dbtek/dbyll">dbyll</a> by dbtek.
			</p>
		</footer>
	</div>

	<script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/assets/js/app.js"></script>
</body>
</html>



<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'johanveldhuis', 'auto');
  ga('send', 'pageview');
</script>

