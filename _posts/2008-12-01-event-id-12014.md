---
id: 957
title: Event id 12014
date: 2008-12-01T22:35:44+00:00
author: Johan Veldhuis
layout: post
guid: http://myuclab.nl/?p=957
permalink: /event-id-12014/
categories:
  - Exchange
---
Event id 12014 is caused by a problem with loading the certificate when setting up a SMTP connection which uses TLS for authentication.

There are several causes which could result in this issue:

  * the certificate is not enabled for SMTP
  * the server doesn&#8217;t have a certificate with the correct FQDN defined in the  subject or subject alternate name

The certificate needs to be place in the computer&#8217;s personal certificate store.

To check the certificates which are installed and the FQDN used by the connectors we need to use the Powershell commands below

```PowerShell
Get-ExchangeCertificate | FL * #this will display a list of certificates available

Get-ReceiveConnector | FL name, fqdn, objectClass #this will display all receive connectors

Get-SendConnector | FL name, fqdn, objectClass #this will display all send connectors</em>
```

The output of the _Get-ExchangeCertificate_ will contain a field labeled _services_, this field described for which services the certificate can be used.  If you want to use the certificate for SMTP the value after _services_ needs to contain SMTP just as you can see below.

[<img class="alignnone size-thumbnail wp-image-958" title="Certificaat Services" src="https://i2.wp.com/myuclab.nl/wp-content/uploads/2008/12/services-150x66.jpg?resize=150%2C66" alt="" width="150" height="66" srcset="https://i1.wp.com/myuclab.nl/wp-content/uploads/2008/12/services.jpg?resize=150%2C66&ssl=1 150w, https://i1.wp.com/myuclab.nl/wp-content/uploads//customers/myuclab.nl/myuclab.nl/httpd.www/wp-content/uploads/2008/12/services.jpg?zoom=2&resize=150%2C66&ssl=1 300w, https://i1.wp.com/myuclab.nl/wp-content/uploads//customers/myuclab.nl/myuclab.nl/httpd.www/wp-content/uploads/2008/12/services.jpg?zoom=3&resize=150%2C66&ssl=1 450w" sizes="(max-width: 150px) 100vw, 150px" data-recalc-dims="1" />](https://i1.wp.com/myuclab.nl/wp-content/uploads/2008/12/services.jpg)

The next step is checking the FQDN, this can be found after the label _CertificateDomains_. This will look like the screenshot below.

[<img class="alignnone size-thumbnail wp-image-959" title="Certificatedomains" src="https://i1.wp.com/myuclab.nl/wp-content/uploads/2008/12/certificate-150x16.jpg?resize=150%2C16" alt="" width="150" height="16" srcset="https://i1.wp.com/myuclab.nl/wp-content/uploads/2008/12/certificate.jpg?resize=150%2C16&ssl=1 150w, https://i2.wp.com/myuclab.nl/wp-content/uploads//customers/myuclab.nl/myuclab.nl/httpd.www/wp-content/uploads/2008/12/certificate.jpg?zoom=2&resize=150%2C16&ssl=1 300w" sizes="(max-width: 150px) 100vw, 150px" data-recalc-dims="1" />](https://i1.wp.com/myuclab.nl/wp-content/uploads/2008/12/certificate.jpg)

When the incorrect FQDN is displayed you will need to get a new certificate. A new certificate request can be generated by executing the following Powershell command _New-ExchangeCertificate. _Besides this type of certificate you can use a 3rd party or custom certificate._ _

```PowerShell
New-ExchangeCertificate -GenerateRequest -SubjectName 'C=NL, O=Test, CN=mail.test.nl' -IncludeAcceptedDomains -DomainName mail.test.nl -Path c:\certificates\mail.test.nl.req
```

The command above will generate a certificate request for example an Edge server with the name mail.test.nl.

When you choose to use a 3rd party certificate or custom certificate which contains the correct FQDN but is not enabled for SMTP. Then you need to use the _Enable-ExchangeCertificate_ Powershell command to enable it for SMTP.

```PowerShell
Enable-ExchangeCertificate -Thumbprint 5113ae0233a72fccb75b1d0198628675333d010e -Services SMTP
```

With the command above we enable the certificate for SMTP.

<a href="http://technet.microsoft.com/en-us/library/aa997231.aspx" target="_blank">Enable-ExchangeCertificate</a>

<a href="http://technet.microsoft.com/en-us/library/aa998840.aspx" target="_blank">Certificate request for SMTP</a>

<a href="http://technet.microsoft.com/en-us/library/bb510128.aspx" target="_blank">How to troubleshoot STARTTLS</a>